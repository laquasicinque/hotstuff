var e={"+":"plus","-":"subtract",",":"comma"," ":"space","   ":"tab",arrowup:"up",arrowdown:"down",arrowleft:"left",arrowright:"right",control:"ctrl",delete:"del"},t=function(){for(var e={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",59:";",61:"equals",91:"meta",92:"meta",93:"select",106:"multiply",107:"plus",109:"subtract",110:"decimal",111:"divide",144:"numlock",145:"scrolllock",186:";",187:"equals",189:"minus",190:".",191:"/",192:"grave",219:"[",220:"\\",221:"]",222:"'",223:"`"},t=0;t<=9;t++)e[48+t]=String.fromCharCode(48+t),e[96+t]="numpad"+t;for(t=0;t<=11;t++)e[112+t]="f"+(t+1);for(t=65;t<91;t++)e[t]=String.fromCharCode(t).toLowerCase();return e}(),n=function(t){return e[t]?e[t]:t},i=function(e,t){return"ctrl"!==e&&"control"!==e||(e="\0"),"alt"===e&&(e=""),"shift"===e&&(e=""),"ctrl"!==t&&"control"!==t||(t="\0"),"alt"===t&&(t=""),"shift"===t&&(t=""),e>t},r=function(e,t){return void 0===(e=e._keys)[t]&&(e[t]={trigger:!1,event:null}),e[t]};function s(e,t){var n=document.createEventObject?document.createEventObject():document.createEvent("Event");for(var i in n.initEvent&&n.initEvent("keyup",!0,!0),e)try{n[i]=e[i]}catch(e){}t.dispatchEvent?t.dispatchEvent(n):t.fireEvent("onkeyup",n)}var o=function(e){this instanceof o?this.init(e):new o(e)};Object.assign(o.prototype,{constructor:o,init:function(e){var t,n,i=this;if(null==e){if(!window)throw new Error("No element found to attach HotStuff to and could not find window object.");e=window}(t=this,function(e,n){return Object.defineProperty(t,e,n)})("el",{get:function(){return e},readOnly:!0,enumerable:!0}),this._keyListeners={},this._keysActive=[],this._unresolvedKeyUps=[],this._genericKeyListeners=[],e.addEventListener("keydown",this.handleKeyDown.bind(this)),e.addEventListener("keyup",this.handleKeyUp.bind(this)),n=function(){i._unresolvedKeyUps.forEach(function(e){s(e._events[e._events.length-1],i.el),e._events.splice()}),i._genericKeyListeners.forEach(function(e){var t=e._keys;for(var n in t)t.hasOwnProperty(n)&&t[n].trigger&&(s(t[n].event,i.el),t[n].trigger=!1)})},["blur","focus"].forEach(function(e){return window.addEventListener(e,n)})},addListener:function(e,t,r){var s=this;if("string"==typeof e&&(e=[e]),null===e&&(e=[]),e instanceof Function&&(r=t,t=e,e=[]),!(e instanceof Array))throw new Error("Invalid Keys provided");if(null==r&&null==t)throw new Error("No handlers provided");null==t&&(t=function(e){return e}),null==r&&(r=function(e){return e});var o={};if(0===e.length){var c=[];return t=t.bind(this),r=r.bind(this),void this._genericKeyListeners.push({keyDown:function(e){return c.push(e),t(e,o,s._keysActive.slice())},keyUp:function(e){return r(e,o,s._keysActive.slice())},_keys:{},_events:c})}e.forEach(function(e){var c;e=(c=e,c.toLowerCase().split(/[+-]/)).map(n).sort(i);var u,a,l=[],h=[];t=t.bind(s),r=r.bind(s),(u=s,a=e.join("+"),void 0===u._keyListeners[a]&&(u._keyListeners[a]=[]),u._keyListeners[a]).push({keyDown:function(e){return h.push(e),l=s._keysActive.slice(),t(e,o,s._keysActive.slice())},keyUp:function(e){return r(e,o,l)},_events:h})})},handleKeyDown:function(e){var s=this,o=(e.which&&e.keyCode?t[e.which||e.keyCode]:e.key).toLowerCase();this._keysActive.includes(o)||(this._keysActive.push(o),this._keysActive.sort(i));var c=this._keysActive.map(n).join("+");null!=this._keyListeners[c]&&this._keyListeners[c].forEach(function(t){!1!==t.keyDown(e)&&(s._unresolvedKeyUps.includes(t)||s._unresolvedKeyUps.push(t))}),this._genericKeyListeners.forEach(function(t){var n=r(t,o);n.trigger=!1!==t.keyDown(e),n.event=e})},handleKeyUp:function(e){var n=(e.which&&e.keyCode?t[e.which||e.keyCode]:e.key).toLowerCase();this._keysActive.includes(n)&&(this._keysActive.splice(this._keysActive.indexOf(n),1),this._keysActive.sort(i)),this._unresolvedKeyUps.forEach(function(t){return t.keyUp(e)}),this._unresolvedKeyUps.splice(0),this._genericKeyListeners.forEach(function(t){var i=r(t,n);!1!==i.trigger&&(t.keyUp(e),i.trigger=!1,i.event=null)})}});export default o;
